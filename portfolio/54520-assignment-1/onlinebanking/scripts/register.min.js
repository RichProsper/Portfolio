import Header from"../../scripts/header.min.js";import{redirectLoggedInUser,randomNumber,randomPosTransactions}from"./utilities.min.js";redirectLoggedInUser(),Header(),document.querySelector("form").addEventListener("submit",(function(e){e.preventDefault();const t=document.getElementById("failure"),r=t.children[1],s=document.getElementById("success"),o=this.name.value.trim(),n=this.creditcard.value.trim(),a=this.email.value.trim(),i=this.password.value.trim(),m=this.confirmPassword.value.trim(),d={name:o,userId:n,creditcard:n,email:a,password:i,balance:randomNumber(5e3,1e4),transactions:{pos:randomPosTransactions(),transfers:[],billPayments:[]}};if(i!==m)return r.textContent="Password and Confirm Password don't match.",void t.openAlert();if(null===localStorage.getItem("users"))return localStorage.setItem("users",JSON.stringify([d])),localStorage.setItem("currentUser",JSON.stringify(d)),s.openAlert(),void setTimeout((()=>location.href="index.html"),5201);const l=JSON.parse(localStorage.getItem("users"));for(const e of l)if(e.userId===n)return r.textContent="There's already a user with that Credit Card Number.",void t.openAlert();l.push(d),localStorage.setItem("users",JSON.stringify(l)),localStorage.setItem("currentUser",JSON.stringify(d)),s.openAlert(),setTimeout((()=>location.href="index.html"),5201)}));